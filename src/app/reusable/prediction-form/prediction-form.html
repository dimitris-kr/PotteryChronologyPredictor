<form [formGroup]="form" (ngSubmit)="submit()" class="flex column gap-5">
    <div class="flex column gap-3">
        <div class="flex row gap-2 justify-start align-center">
            <h4 class="m-0">Pottery Item</h4>
            <button
                matIconButton
                aria-label="help"
                matTooltip="Enter a description and/or an image of the pottery item you wish to get a chronology prediction for."
                matTooltipPosition="after"
            >
                <mat-icon>info</mat-icon>
            </button>
        </div>

        <div class="flex row wrap justify-between gy-2">
            <div class="w-6">
                <mat-form-field appearance="outline" floatLabel="always" class="w-100 description-field">
                    <mat-label>Description</mat-label>

                    <textarea
                        matInput
                        rows="7"
                        formControlName="text"
                        placeholder="Write a short description of the pottery item ..."
                    ></textarea>

                </mat-form-field>
            </div>
            <div class="w-6">
                <div
                    class="image-upload"
                    [class.has-image]="imagePreviewUrl"
                    (click)="fileInput.click()"
                    (dragover)="onDragOver($event)"
                    (drop)="onFileDrop($event)"
                >
                    <span class="label">Image</span>
                    <input
                        #fileInput
                        type="file"
                        accept="image/*"
                        hidden
                        (change)="onFileSelected($event)"
                    />

                    @if (imagePreviewUrl) {
                        <img [src]="imagePreviewUrl" alt="Preview" />
                        <button
                            mat-icon-button
                            class="remove-btn"
                            (click)="clearImage(); $event.stopPropagation()"
                        >
                            <mat-icon>delete</mat-icon>
                        </button>
                    } @else {
                        <div class="placeholder">
                            <mat-icon class="upload-icon">add_photo_alternate</mat-icon>
                            <p>Drag & Drop or Click to<br /> Upload Image of Pottery</p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>


    <div class="flex column gap-3">
        <div class="flex row gap-2 justify-start align-center">
            <h4 class="m-0">Chronology Type</h4>
            <button
                matIconButton
                aria-label="help"
                matTooltip="Choose the type of chronology you wish the prediction output to have."
                matTooltipPosition="after"
            >
                <mat-icon>info</mat-icon>
            </button>
        </div>

        <div>
            <mat-button-toggle-group
                formControlName="task"
                class="chronology-toggle"
            >
                <mat-button-toggle value="classification">
                    Historical Period
                </mat-button-toggle>

                <mat-button-toggle value="regression">
                    Exact Years
                </mat-button-toggle>
            </mat-button-toggle-group>
        </div>
    </div>

    <div class="flex justify-start align-center py-3">
        <button
            matButton="filled"
            color="primary"
            type="submit"
            class="predict-btn"
            [disabled]="(loader.loading$ | async) || form.invalid"
        >
            <mat-icon>auto_fix_high</mat-icon>
            @if (loader.loading$ | async){
                Predicting Chronologyâ€¦
            } @else {
                Predict Chronology
            }
        </button>
    </div>

    <div>
        {{form.value | json}}
    </div>

</form>
